<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Swagger / OpenAPI TOC</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,\"Helvetica Neue\",Arial;margin:0;padding:0;background:#f7fafc;color:#0f172a}
    header{background:#0f172a;color:#fff;padding:1rem 1.25rem}
    .container{max-width:1100px;margin:1rem auto;padding:1rem}
    .card{background:#fff;border-radius:8px;box-shadow:0 6px 18px rgba(2,6,23,0.06);padding:1rem;margin-bottom:1rem}
    .spec-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:0.75rem}
    .spec-item{border:1px solid #e6eef6;padding:0.75rem;border-radius:6px;display:flex;flex-direction:column}
    .spec-item h4{margin:0 0 0.5rem 0;font-size:16px}
    .spec-actions{margin-top:auto;display:flex;gap:0.5rem}
    .btn{padding:0.45rem 0.6rem;border-radius:6px;border:0;cursor:pointer}
    .btn-link{background:#eef2ff}
    .btn-open{background:#e6ffef}
    #viewer{height:70vh;border:none;width:100%;border-radius:8px}
    input[type=search]{width:100%;padding:0.5rem;border-radius:6px;border:1px solid #dfe7f2}
    .small{font-size:13px;color:#334155}
    footer{padding:1rem;text-align:center;color:#94a3b8}
  </style>
  <!-- Swagger UI from CDN -->
  <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist/swagger-ui.css" />
  <script src="https://unpkg.com/swagger-ui-dist/swagger-ui-bundle.js"></script>
</head>
<body>
  <header>
    <strong>Swagger / OpenAPI - Table of Contents</strong>
    <div class="small">Click a spec to open it in the embedded viewer or open in a new tab.</div>
  </header>

  <div class="container">
    <div class="card">
      <label for="q">Search specs</label>
      <input id="q" type="search" placeholder="filter by name or path..." />
    </div>

    <div class="card">
      <h3>Specifications</h3>
      <div id="specList" class="spec-list"></div>
    </div>

    <div class="card">
      <h3>Embedded viewer</h3>
      <div id="ui"></div>
    </div>

    <div class="card small">
      <strong>Notes</strong>
      <ul>
        <li>Add your swagger JSON/YAML files to the same server (or use raw URLs) and update the <code>specs</code> array below.</li>
        <li>For automatic generation, see the Python script included at the bottom of this file.</li>
      </ul>
    </div>

    <footer class="small">Generated by swagger-toc â€” embed or open any OpenAPI/Swagger spec</footer>
  </div>

  <script>
    // === CONFIG: put your specs here ===
    // Each entry: { "name": "Friendly name", "url": "relative-or-absolute-url-to-swagger.json|yaml" }
    const specs = [
      { name: 'Users API', url: './specs/users.openapi.json' },
      { name: 'Orders API', url: './specs/orders.openapi.yaml' },
      { name: 'Inventory API', url: './specs/inventory.json' }
    ];

    // === End CONFIG ===

    const specListEl = document.getElementById('specList');
    const uiContainer = document.getElementById('ui');
    let currentUi = null;

    function renderSpecItem(spec){
      const el = document.createElement('div');
      el.className = 'spec-item';
      const h = document.createElement('h4'); h.textContent = spec.name;
      const p = document.createElement('div'); p.className = 'small'; p.textContent = spec.url;
      const actions = document.createElement('div'); actions.className = 'spec-actions';

      const btnOpen = document.createElement('button'); btnOpen.className='btn btn-open'; btnOpen.textContent='Open (embed)';
      btnOpen.onclick = ()=> loadInViewer(spec.url);

      const btnNew = document.createElement('button'); btnNew.className='btn btn-link'; btnNew.textContent='Open in new tab';
      btnNew.onclick = ()=> window.open(spec.url, '_blank');

      actions.appendChild(btnOpen); actions.appendChild(btnNew);
      el.appendChild(h); el.appendChild(p); el.appendChild(actions);
      return el;
    }

    function populate(list){
      specListEl.innerHTML='';
      list.forEach(s=> specListEl.appendChild(renderSpecItem(s)));
    }

    function loadInViewer(url){
      // destroy previous UI if exists
      uiContainer.innerHTML = '';
      if(window.SwaggerUIBundle){
        SwaggerUIBundle({
          url: url,
          domNode: uiContainer,
          deepLinking: true,
          presets: [SwaggerUIBundle.presets.apis],
          layout: 'BaseLayout'
        });
      } else {
        uiContainer.textContent = 'Swagger UI not loaded';
      }
    }

    // search
    const q = document.getElementById('q');
    q.addEventListener('input', ()=>{
      const v = q.value.trim().toLowerCase();
      if(!v) populate(specs);
      else populate(specs.filter(s=> (s.name + ' ' + s.url).toLowerCase().includes(v)));
    });

    // initial
    populate(specs);

    // optional: if you want the first spec loaded by default uncomment:
    // if(specs.length) loadInViewer(specs[0].url);
  </script>

  <!--
    OPTIONAL: Python script to auto-generate the `specs` array by scanning a directory.
    Save as generate_toc.py and run from the directory that contains your `specs/` folder.

    Usage: python generate_toc.py --dir ./specs --out ./swagger-toc.html

    The script will insert a JSON array into the HTML file (replacing the placeholder specs array).
  -->
  <!-- python
  import os, json, argparse

  parser = argparse.ArgumentParser()
  parser.add_argument('--dir', default='./specs', help='directory containing swagger files')
  parser.add_argument('--html', default='swagger-toc.html', help='path to the HTML template to update')
  args = parser.parse_args()

  files = []
  for name in sorted(os.listdir(args.dir)):
      if name.lower().endswith(('.json','.yaml','.yml')):
          files.append({'name': os.path.splitext(name)[0].replace('_',' ').title(), 'url': os.path.join(args.dir, name).replace('\\','/')})

  # read template
  with open(args.html, 'r', encoding='utf-8') as f:
      html = f.read()

  start = html.find('const specs = [')
  if start==-1:
      print('Could not find specs placeholder')
      raise SystemExit(1)
  end = html.find('];', start)
  new_array = json.dumps(files, indent=2)
  html = html[:start] + 'const specs = ' + new_array + ';' + html[end+2:]

  with open('swagger-toc.generated.html','w',encoding='utf-8') as f:
      f.write(html)

  print('Generated swagger-toc.generated.html with', len(files), 'specs')
  -->

</body>
</html>
